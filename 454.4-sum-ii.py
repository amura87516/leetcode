#
# @lc app=leetcode id=454 lang=python3
#
# [454] 4Sum II
#

# @lc code=start
class Solution:
    def fourSumCount(self, nums1: List[int], nums2: List[int], nums3: List[int], nums4: List[int]) -> int:
        def count(nums):
            counter = {}
            for num in nums:
                if num in counter:
                    counter[num] += 1
                else:
                    counter[num] = 1
            return counter

        # O(n)
        counter1 = count(nums1)
        counter2 = count(nums2)

        # O(n^2)
        counter = {}
        for num in counter1:
            for num2 in counter2:
                target = num + num2
                if target in counter:
                    counter[target] += counter1[num] * counter2[num2]
                else:
                    counter[target] = counter1[num] * counter2[num2]

        # O(n^2)
        res = 0
        for num in nums3:
            for num2 in nums4:
                target = (num + num2)*-1
                if target in counter:
                    res += counter[target]
        return res
# @lc code=end

# Testcase
# [15,4,-11,-17,-11,7,2,4,47,94,60,53,35,46,11,-67,1,16,-66,-65,-34,64,-60,1,91,-41,-6,81,95,-17,62,50,-46,-7,66,100,60,83,92,70,7,12,68,25,-33,-64,-29,6,16,-49,64,-19,-72,-30,-12,-2,8,-81,12,3,16,-84,16,13,9,78,7,-77,40,30,91,84,-21,47,-11,-21,-56,62,0,28,96,-26,81,53,63,12,-40,54,-13,-29,-4,-57,68,42,-76,6,-62,-48,82,-25,83,93,-55,-90,-19,21,-27,-59,53,-64,-36,91,56,66,92,-84,16,-45,32,57,-12,5,-29,-99,19,58,-38,18,100,83,94,31,-17,83,-78,-17,-99,-80,23,83,7,53,87,-60,8,-40,-73,-60,24,100,47,-75,61,-48,52,-93,77,21,-70,-3,-71,-60,54,49,57,85,54,-12,-1,23,-83,82,-79,-51,-88,-63,19,-100,-66,-44,-45,22,-34,21,-10,-99,76,-18,-24,66,-24,50,28,-57]
# \n[49,-60,83,44,-72,77,45,-21,-11,94,-58,-93,32,-12,-88,-37,-85,93,-45,55,-20,92,91,76,-75,28,84,71,57,-71,-91,-14,-78,-68,-81,-83,-41,-49,-39,28,8,3,-90,-20,-46,20,60,48,11,-44,-36,29,-84,-87,28,-48,48,-87,-38,100,74,64,46,60,13,-22,98,91,-50,89,70,3,90,92,-90,35,1,39,-60,95,-32,-63,-37,-87,44,6,-3,-72,-28,33,72,82,-55,-50,-60,47,-28,68,87,85,-19,42,-94,97,50,-66,-14,53,-95,-67,41,-62,-35,-33,-24,88,-53,13,90,-27,-36,31,-18,-56,-45,14,74,-85,-70,69,42,63,-20,35,73,-99,97,-41,36,30,-27,27,95,-36,-71,-84,-22,-19,-26,-66,31,-66,37,-44,-52,-65,-84,5,-14,67,-62,-51,-64,22,15,-34,32,-28,-15,9,-66,61,-85,4,59,-18,-59,52,49,-81,57,-80,-63,-48,-1,-66,3,45,47,12,-42,59,9,-37]
# \n[10,-78,24,4,-70,85,-39,-9,59,-22,-13,58,26,96,72,68,-30,-83,41,77,-76,-24,18,46,42,35,30,88,95,-34,-75,-52,-56,-38,-1,59,-3,24,51,35,-26,-31,10,-60,-25,86,-59,80,-51,77,-58,67,16,3,66,55,46,-28,50,-96,-52,60,23,-59,-34,-66,-54,-65,47,32,-17,-62,-77,-78,-94,-34,59,44,79,71,-30,-15,-73,50,19,52,28,50,91,60,7,73,-17,-82,77,79,-43,-18,-54,22,20,69,-59,62,50,53,-11,-35,-57,-36,64,-85,-6,0,-41,16,12,-31,85,8,36,5,-60,82,-89,-92,-68,-49,-40,-96,-33,41,38,27,-51,-42,-34,65,48,47,67,-24,7,-75,71,100,35,-64,6,3,-48,15,95,90,3,6,40,-42,-92,66,89,65,-23,-38,-4,71,-7,73,-14,-77,-94,51,-25,-73,38,47,20,-12,58,64,-23,57,-19,-62,81,13,86,-11,76,19,90,58,37,98]
# \n[-24,-37,-39,41,-9,-33,-68,29,87,7,16,-32,-23,-24,87,85,-52,69,-62,-51,-2,-18,93,-41,-59,60,-81,-2,81,-58,-10,-100,34,19,24,-86,82,-1,29,36,80,-49,83,62,59,89,-48,-2,68,29,-35,51,-51,35,33,-78,-80,-9,-8,-79,-9,-78,61,76,100,-86,77,-20,46,76,24,-31,-41,41,-7,-8,-66,-59,-54,19,70,43,-8,-72,61,-22,53,73,-22,-39,31,52,-100,-76,-24,-36,-60,-93,-30,-73,-59,-58,-12,87,27,-15,-80,-67,43,-66,-15,-64,-64,-29,21,46,9,-35,-18,-7,-53,-59,73,82,58,-89,-70,81,73,-51,-79,36,84,15,9,37,-78,44,99,4,1,20,19,16,-96,50,9,88,-86,25,-72,100,-75,-70,62,-5,58,85,-98,-63,41,-12,80,-57,-100,-20,-40,-70,50,100,82,54,100,24,-41,5,-70,99,17,82,43,-30,25,0,85,-90,-80,-67,96,41,-89,-14,87,57]
[-1,-1]\n[-1,1]\n[-1,1]\n[1,-1]